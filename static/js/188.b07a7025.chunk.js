"use strict";(self.webpackChunktetris_react=self.webpackChunktetris_react||[]).push([[188],{188:function(e,o,t){t.r(o);var r,c,n,a,l=t(381),i=t(412),s=t(982),u=t(942),d=t(885),f=t(413),h=function(e){var o=(0,l.useState)(!1),t=(0,d.Z)(o,2),r=t[0],c=t[1],n=function(o){o.key===e&&c(!0)},a=function(o){o.key===e&&c(!1)};return(0,l.useEffect)((function(){return window.addEventListener("keydown",n),window.addEventListener("keyup",a),function(){window.removeEventListener("keydown",n),window.removeEventListener("keyup",a)}}),[]),r};!function(e){e[e.Stage=0]="Stage",e[e.Next=1]="Next",e[e.Swap=2]="Swap"}(r||(r={})),function(e){e[e.a=0]="a",e[e.b=1]="b",e[e.c=2]="c",e[e.d=3]="d",e[e.e=4]="e",e[e.f=5]="f",e[e.g=6]="g",e[e.h=7]="h",e[e.i=8]="i",e[e.j=9]="j"}(c||(c={})),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(n||(n={})),function(e){e[e.Over=0]="Over",e[e.Play=1]="Play",e[e.Pause=2]="Pause"}(a||(a={}));var w=JSON.parse('{"i":{"name":"i","color":"bg-blue-400","sprite":[{"row":0,"col":2},{"row":1,"col":2},{"row":2,"col":2},{"row":3,"col":2}],"height":4,"width":1,"row":0,"column":2},"j":{"name":"j","color":"bg-red-400","sprite":[{"row":1,"col":1},{"row":1,"col":2},{"row":1,"col":3},{"row":2,"col":3}],"height":2,"width":3,"row":1,"column":1},"l":{"name":"l","color":"bg-orange-400","sprite":[{"row":1,"col":3},{"row":2,"col":1},{"row":2,"col":2},{"row":2,"col":3}],"height":2,"width":3,"row":1,"column":1},"o":{"name":"o","color":"bg-yellow-400","sprite":[{"row":1,"col":1},{"row":1,"col":2},{"row":2,"col":1},{"row":2,"col":2}],"height":2,"width":2,"row":1,"column":1},"s":{"name":"s","color":"bg-green-400","sprite":[{"row":1,"col":2},{"row":1,"col":3},{"row":2,"col":1},{"row":2,"col":2}],"height":2,"width":3,"row":1,"column":1},"t":{"name":"t","color":"bg-pink-400","sprite":[{"row":1,"col":2},{"row":2,"col":1},{"row":2,"col":2},{"row":2,"col":3}],"height":2,"width":3,"row":1,"column":1},"z":{"name":"z","color":"bg-purple-400","sprite":[{"row":1,"col":1},{"row":1,"col":2},{"row":2,"col":2},{"row":2,"col":3}],"height":2,"width":3,"row":1,"column":1}}'),m=t.t(w,2),p=t(343),g=function(e){var o=e.spots,t=e.width,r=e.height,c=e.hide;return(0,p.jsx)(p.Fragment,{children:o.length>0&&(null===o||void 0===o?void 0:o.map((function(e,o){return(0,p.jsx)("div",{className:c?"hidden":"",children:(0,p.jsx)("div",{className:["ease-linear ".concat(e.fixed?"duration-200":"duration-75"),e.color,t,r,e.fixed?"rounded-xs border":"bg-slate-400"===e.color?"border border-slate-500":"border"].join(" ")})},"spot-".concat(o))})))})},v=function(e){var o=e.gameMode,t=e.columns,r=e.board,c=e.title,n=e.width;return(0,p.jsxs)("fieldset",{className:"".concat(o?"opacity-100":"opacity-25"," p-4 text-sm align-middle border-2 rounded-md h-fit border-slate-700 text-slate-500 dark:text-slate-400"),children:[(0,p.jsx)("legend",{className:"mx-auto text-base font-medium tracking-tight text-slate-900 dark:text-white",children:c}),(0,p.jsx)("div",{className:"grid gap-0 grow-0 grid-cols-".concat(t," ").concat(n," place-content-center"),children:r.map((function(e,o){return(0,p.jsx)(g,{spots:e,width:"w-4",height:"h-4"},"next-".concat(o))}))})]})},x=function(e){var o=e.gameMode,t=e.heading,r=e.children;return(0,p.jsxs)("div",{className:"absolute inset-x-0 z-10 w-72 mx-auto capitalize top-48",children:[(0,p.jsx)("h1",{className:"text-5xl ".concat(o===a.Over?"text-red-500":"text-blue-500"," font-extrabold opacity-100"),children:t}),(0,p.jsx)("div",{className:"",children:r})]})},b=function(){for(var e,o="ijlostz",t=700,c={color:"bg-slate-400",fixed:!1,row:0,col:0,value:"0"},n=new Array(12).fill({color:"bg-slate-400",fixed:!1}),i=[],w=0;w<21;w++){for(var b=[],j=0;j<12;j++)b.push((0,f.Z)((0,f.Z)({},c),{},{color:"bg-slate-400",col:j,row:w,value:"r".concat(w," c").concat(j)}));i.push(b)}for(var Z=[],y=0;y<4*o.length;y++){for(var S=[],k=0;k<5;k++)S.push((0,f.Z)((0,f.Z)({},c),{},{color:"bg-slate-200",col:k,row:y,value:"r".concat(y," c").concat(k)}));Z.push(S)}for(var E=[],N=0;N<4;N++){for(var P=[],C=0;C<5;C++)P.push({fixed:!0,color:"bg-slate-200",col:C,row:N,value:"r".concat(N," c").concat(C)});E.push(P)}var A=m,z=(0,l.useState)([A.t,A.j,A.z,A.o,A.i,A.l,A.z]),M=(0,d.Z)(z,2),L=M[0],F=M[1],O=Array.from(Z),D=0;L.forEach((function(e){e.sprite.forEach((function(o){O[o.row+4*D].splice(o.col,1,{col:o.col,row:o.row,color:e.color,fixed:!0,value:"r".concat(o.row," c").concat(o.col)})})),D++}));var I=(0,l.useState)(i),R=(0,d.Z)(I,2),T=R[0],U=R[1],B=(0,l.useState)(O),_=(0,d.Z)(B,2),G=_[0],H=_[1],J=(0,l.useState)(E),V=(0,d.Z)(J,2),W=V[0],q=V[1],K=(0,l.useState)(A.j),Q=(0,d.Z)(K,2),X=Q[0],Y=Q[1],$=(0,l.useState)(A.t),ee=(0,d.Z)($,2),oe=ee[0],te=ee[1],re=(0,l.useState)(),ce=(0,d.Z)(re,2),ne=ce[0],ae=ce[1],le=(0,l.useState)(t),ie=(0,d.Z)(le,2),se=ie[0],ue=ie[1],de=(0,l.useState)(t),fe=(0,d.Z)(de,2),he=fe[0],we=fe[1],me=(0,l.useState)(0),pe=(0,d.Z)(me,2),ge=pe[0],ve=pe[1],xe=(0,l.useState)(0),be=(0,d.Z)(xe,2),je=be[0],Ze=(be[1],(0,l.useState)(!1)),ye=(0,d.Z)(Ze,2),Se=ye[0],ke=ye[1],Ee=(0,l.useState)(!1),Ne=(0,d.Z)(Ee,2),Pe=Ne[0],Ce=Ne[1],Ae=(0,l.useState)(a.Play),ze=(0,d.Z)(Ae,2),Me=ze[0],Le=ze[1],Fe=(0,l.useState)("paused"),Oe=(0,d.Z)(Fe,2),De=Oe[0],Ie=Oe[1],Re=(0,l.useState)(0),Te=(0,d.Z)(Re,2),Ue=Te[0],Be=Te[1],_e=(0,l.useState)(0),Ge=(0,d.Z)(_e,2),He=Ge[0],Je=Ge[1],Ve=h("ArrowLeft"),We=h("ArrowRight"),qe=h("ArrowUp"),Ke=h("ArrowDown"),Qe=h("Enter"),Xe=h("w"),Ye=h("a"),$e=h("s"),eo=h("d"),oo=h("Shift"),to=h("Escape"),ro=h(" "),co=Me===a.Play,no=co&&ro,ao=co&&no&&oo,lo=co&&(Ve||Ye),io=co&&(We||eo),so=co&&Qe,uo="block text-xl font-medium px-4 py-2 mt-4 capitalize text-sky-500 border-sky-600 hover:bg-sky-200 active:bg-sky-300 hover:text-sky-600 transition ease-in duration-400 border-2 rounded-md ".concat(Me?"":"cursor-default"),fo=(e={},(0,u.Z)(e,r.Stage,{board:T,set:U,bgColor:"bg-slate-400"}),(0,u.Z)(e,r.Next,{board:G,set:H,bgColor:"bg-slate-200"}),(0,u.Z)(e,r.Swap,{board:W,set:q,bgColor:"bg-slate-200"}),e),ho=function(){U(i),q(E),ve(0),ue(t),we(t),Be(0),Le(a.Play)},wo=function(e,o,t){var r=(0,s.Z)(T);e.sprite.forEach((function(e){var c;!(null===(c=r[e.row][e.col])||void 0===c?void 0:c.fixed)&&r[e.row].splice(e.col,1,{row:e.row,col:e.col,color:o,fixed:t,value:"r".concat(e.row," c").concat(e.col)})})),U(go(r))},mo=function(e,o){var t=(0,s.Z)(fo[o].board).map((function(e){return e.map((function(e){return(0,f.Z)((0,f.Z)({},e),{},{color:e.fixed?e.color:fo[o].bgColor})}))}));e.sprite.forEach((function(o){t[o.row].splice(o.col,1,{row:0,col:o.col,color:e.color,fixed:!1,value:"r".concat(o.row," c").concat(o.col)})})),fo[o].set(t)},po=function(e,o){Y((function(t){return wo(t,"bg-slate-400",!1),wo(e,o?e.color.replace("4","6"):e.color,!!o),e}))},go=function(e){var o,t=null!==(o=e.filter((function(e){return 12!==e.filter((function(e){return e.fixed})).length})))&&void 0!==o?o:[];if(t.length<e.length){for(var r=t.length,c=0,a=0;a<=e.length-1-r;a++)t.unshift((0,s.Z)(n)),c++,console.info("line cleared");Be(Ue+c),we(he-10*c)}return t};return(0,l.useEffect)((function(){ho();var e=localStorage.getItem("highScore");e&&Je(Number(e))}),[]),(0,l.useEffect)((function(){Me===a.Play&&to&&(Le(a.Pause),Ie("paused"))}),[to]),(0,l.useEffect)((function(){Me===a.Play&&Ce(Ke||$e)}),[Ke,$e]),(0,l.useEffect)((function(){Me===a.Play&&(qe||Xe)&&ke(!0)}),[qe,Xe]),(0,l.useEffect)((function(){Me===a.Play&&ge>0&&ue(Se?se/1e4:he)}),[Se]),(0,l.useEffect)((function(){Me===a.Play&&ge>0&&ue(Pe?se/10:he)}),[Pe]),(0,l.useEffect)((function(){ge>0&&(Ie("game over"),Le(a.Over),Ue>He&&(localStorage.setItem("highScore",Ue.toString()),Je(Ue)),console.info("GAME OVER"))}),[T[0].some((function(e){return e.fixed}))]),(0,l.useEffect)((function(){if(so){so=!1,console.info("SWAP");var e=ne;if(!e){e=oe;var t=o.charAt(Math.floor(6*Math.random()));L.shift(),L.push(A[t]),F(L),mo(A[t],r.Next),te(A[t])}e.column=A[e.name].column,e.row=A[e.name].row,e.sprite=A[e.name].sprite,mo((0,f.Z)((0,f.Z)({},X),{},{color:"bg-slate-400"}),r.Stage),mo(A[X.name],r.Swap),ae(X),Y(e)}}),[so]),(0,l.useEffect)((function(){var e=!1;if(X.row+X.height<=20){var o,t=!0;null===X||void 0===X||null===(o=X.sprite)||void 0===o||o.forEach((function(e){var o,r=null===(o=T[e.row+1][e.col])||void 0===o?void 0:o.fixed;r&&(t=!r)})),t?po((0,f.Z)((0,f.Z)({},X),{},{row:X.row+1,sprite:X.sprite.map((function(e){return(0,f.Z)((0,f.Z)({},e),{},{row:e.row+1})}))})):po(X,e=!0)}else po(X,e=!0);if(e){var r;ke(!1),Ce(!1);var c=A.j;switch(oe.name){case"i":c=A.j;break;case"j":c=A.l;break;case"l":c=A.o;break;case"o":c=A.s;break;case"s":c=A.t;break;case"t":c=A.z;break;default:c=A.i}var n=(0,s.Z)(L),l=null!==(r=n.shift())&&void 0!==r?r:c;po(l),te(n[0]),n.push(c),F(n);for(var i=(0,s.Z)(G),u=0;u<4;u++)i.shift();var d=Array.from(E);c.sprite.forEach((function(e){d[e.row].splice(e.col,1,{color:c.color,col:e.col,row:e.row,fixed:!1,value:"idc"})})),i.push.apply(i,(0,s.Z)(d)),H(i)}var h=setTimeout((function(){Me===a.Play&&ve(ge+1)}),se);return function(){return clearInterval(h)}}),[ge,se,ne,Me]),(0,l.useEffect)((function(){var e=lo?X.column:X.column+X.width,o=lo&&e>0?-1:io&&e<12?1:0,t=!0;X.sprite.forEach((function(e){var r,c=null===(r=T[e.row][e.col+o])||void 0===r?void 0:r.fixed;c&&(t=!c)})),t&&po((0,f.Z)((0,f.Z)({},X),{},{column:X.column+o,sprite:X.sprite.map((function(e){return(0,f.Z)((0,f.Z)({},e),{},{col:e.col+o})}))}))}),[lo,io,je]),(0,l.useEffect)((function(){if(no||ao){var e=function(e,o){for(var t=1,r=Math.max(e.height,e.width)+1,c=[],n=0;n<r;n++){c.push([]);for(var a=0;a<r;a++)c[n].push(0)}e.sprite.forEach((function(o){c[o.row-e.row+1][o.col-e.column+1]=t++}));for(var l=[].concat(c),i=0;i<("ccw"===o?3:1);i++)l=l[0].map((function(e,o){return l.map((function(e){return e[o]})).reverse()}));var s=[];l.forEach((function(o,t){o.forEach((function(o,r){var c=o>0?o-1:-1;c>=0&&(null===s||void 0===s||s.splice(c,0,{row:t+e.row-1,col:r+e.column-1}))}))}));var u=s.reduce((function(e,o){return{col:e.col<o.col?e.col:o.col,row:e.row<o.row?e.row:o.row}}),{col:s[0].col,row:s[0].row});return[s,u]}(X,no?"cw":"ccw"),o=(0,d.Z)(e,2),t=o[0],r=o[1];po((0,f.Z)((0,f.Z)({},X),{},{sprite:t,height:X.width,width:X.height,row:r.row,column:r.col}))}}),[no,ao]),(0,p.jsx)("div",{className:"flex w-full h-screen dark:bg-slate-900",children:(0,p.jsxs)("div",{className:"relative flex p-4 m-2 ",children:[(0,p.jsx)(v,{board:G,gameMode:Me,columns:G[0].length,title:"Next"}),(0,p.jsx)("div",{className:"transition-opacity duration-1000 ease-out justify-items-start ".concat(Me===a.Play?"opacity-0 cursor-default":"opacity-100"),children:(0,p.jsxs)(x,{gameMode:Me,heading:De,children:[Me===a.Pause?(0,p.jsx)("button",{className:"mr-4 ".concat(uo),onClick:function(){setTimeout((function(){return Ie("paused")}),1100),Le(a.Play)},children:"resume"},"button-resume"):(0,p.jsx)(p.Fragment,{}),(0,p.jsx)("button",{className:"".concat(uo.replaceAll("sky",Me===a.Over?"fuchsia":"emerald")),onClick:function(){return Me!==a.Play?ho():{}},children:"new game"},"button-reset")]})}),(0,p.jsx)("div",{className:["place-content-center content-start","px-4 w-96 mx-auto grid gap-0 grid-cols-".concat(12..toString()),"".concat(Me===a.Play?"opacity-100":"opacity-25"),"transition duration-1000 z-0"].join(" ").trim(),children:T.map((function(e,o){return(0,p.jsx)(g,{spots:e,width:"w-8",height:"h-8",hide:0===o},o)}))}),(0,p.jsxs)("div",{className:"text-green-400",children:[(0,p.jsx)("div",{className:"w-16",children:(0,p.jsx)(v,{board:W,width:"w-20",columns:W[0].length,gameMode:Me,title:"Swap"})}),(0,p.jsx)("h3",{className:"mt-4 text-xl text-indigo-400",children:"High Score"}),(0,p.jsxs)("p",{className:"text-indigo-400",children:[He," rows"]}),(0,p.jsxs)("div",{className:"flex mt-4",children:[(0,p.jsx)("h3",{className:"",children:"Rows Cleared:"}),(0,p.jsx)("p",{children:"\xa0 ".concat(Ue)})]}),(0,p.jsxs)("div",{className:"flex mt-4",children:[(0,p.jsx)("h3",{className:"",children:"Fall Delay:"}),(0,p.jsx)("p",{children:"\xa0 ".concat(se," ms")})]}),(0,p.jsxs)("div",{className:"flex mt-4",children:[(0,p.jsx)("h3",{className:"",children:"Ticks:"}),(0,p.jsx)("p",{children:"\xa0 ".concat(ge)})]})]})]})})};var j=function(){return(0,p.jsx)("div",{children:(0,p.jsx)(b,{})})},Z=function(e){e&&e instanceof Function&&t.e(111).then(t.bind(t,111)).then((function(o){var t=o.getCLS,r=o.getFID,c=o.getFCP,n=o.getLCP,a=o.getTTFB;t(e),r(e),c(e),n(e),a(e)}))};i.render((0,p.jsx)(l.StrictMode,{children:(0,p.jsx)(j,{})}),document.getElementById("tetrisroot")),Z()}}]);
//# sourceMappingURL=188.b07a7025.chunk.js.map